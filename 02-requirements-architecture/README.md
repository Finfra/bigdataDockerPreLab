# 2. 요구사항 분석과 아키텍처 설계

## 비즈니스 요구사항 분석
### 2.1 기능적 요구사항
* **데이터 수집**
  - 5개 장비로부터 실시간 센서 데이터 수집
  - API 호출 실패 시 재시도 로직
  - 데이터 무결성 보장

* **데이터 처리**
  - 센서 값 범위 검증 (sensor1-3: 0-100, motor1-3: 0-2000)
  - 이상치 탐지 및 플래깅
  - 장비별 통계 정보 생성 (평균, 최대, 최소값)

* **모니터링 및 알림**
  - 실시간 대시보드 제공
  - 임계값 초과 시 즉시 알림
  - 장비 장애(isFail=true) 시 긴급 알림

### 2.2 비기능적 요구사항
* **성능 요구사항**
  - 지연시간: 데이터 수집부터 처리까지 30초 이내
  - 처리량: 초당 50개 메시지 처리 가능
  - 가용성: 99.5% 시스템 가동률

* **확장성 요구사항**
  - 장비 수 확장 가능 (최대 100개)
  - 센서 종류 추가 가능
  - 클러스터 노드 확장 가능

## 데이터 파이프라인 아키텍처 설계
### 2.1 전체 아키텍처 개요
```
[Web API] → [Data Collector] → [Kafka] → [Spark Streaming] → [HDFS]
                                   ↓
                            [Real-time Dashboard]
                                   ↓
                              [Alert System]
```

### 2.2 컴포넌트별 상세 설계
* **Data Collector (Python)**
  - 멀티스레딩으로 5개 장비 동시 수집
  - Kafka Producer로 메시지 발행
  - 에러 핸들링 및 재시도 로직

* **Kafka Cluster**
  - Topic: `fms-sensor-data` (파티션 5개, 복제본 2개)
  - 메시지 보존 기간: 7일
  - 압축 설정: gzip

* **Spark Streaming**
  - 배치 인터벌: 10초
  - 데이터 전처리 및 검증
  - 집계 데이터 생성

* **HDFS Storage**
  - 파티션 구조: `/year/month/day/hour/`
  - 파일 형식: Parquet
  - 압축: Snappy

## 기술 스택 선정 및 역할 분담
### 2.3 기술 스택 선정 기준
| 컴포넌트      | 기술         | 선정 이유                          |
| ------------- | ------------ | ---------------------------------- |
| 메시지 브로커 | Apache Kafka | 높은 처리량, 내구성, 확장성        |
| 스트림 처리   | Apache Spark | 배치/스트림 통합, 풍부한 API       |
| 분산 저장     | Hadoop HDFS  | 대용량 데이터, 내결함성            |
| 컨테이너화    | Docker       | 환경 일관성, 배포 용이성           |
| 시각화        | Grafana      | 실시간 대시보드, 다양한 데이터소스 |


### 2.4 팀 역할 분담 (3인 기준)
* **팀장 (Infrastructure)**: Docker 환경 구성, 클러스터 관리
* **데이터 엔지니어**: Kafka/Spark 파이프라인 개발
* **백엔드 개발자**: 데이터 수집기, API 개발
* **프론트엔드 개발자**: 대시보드, 알림 시스템 개발

## 프로젝트 일정 및 마일스톤 설정
### 2.5 상세 일정표
| 주차  | 주요 활동                | 산출물      |
| ----- | ------------------------ | ----------- |
| 1일차 | 환경 구성, 요구사항 분석 | 설계 문서   |
|       | Docker 클러스터 구축     | 실행 환경   |
| 2일차 | 데이터 파이프라인 개발   | 핵심 모듈   |
|       | 통합 테스트              | 통합 시스템 |
| 3일차 | 모니터링 시스템 구현     | 완성 시스템 |
|       | 문서화 및 발표 준비      | 최종 결과물 |

### 2.6 주요 마일스톤
* **M1 (Day 1)**: Docker 기반 클러스터 환경 구축 완료
* **M2 (Day 2)**: 실시간 데이터 파이프라인 구현 완료
* **M3 (Day 3)**: 전체 시스템 통합 테스트 완료 및 프로젝트 완료 및 발표


